<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/head') %>
</head>
<body>
    <%- include('partials/navbar') %>

    <div class="index-container">

        <div>
            <h1 class="messages-intro">Posts</h1>
            <% if (locals.messages.length > 0 && locals.messages)  {%>
                <div class="messages-container">
                    <% messages.map((message) => { %>
                        <div class="message-card">
                            <% if (locals.user && user.id == message.authorId) {%>
                                <button class="delete-message-button" data-messageid="<%= message.id %>">Delete</button>
                            <% } %>
                            <h1 class="message-author"><% if(locals.user) { %>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M304 128a80 80 0 1 0 -160 0 80 80 0 1 0 160 0zM96 128a128 128 0 1 1 256 0A128 128 0 1 1 96 128zM49.3 464l349.5 0c-8.9-63.3-63.3-112-129-112l-91.4 0c-65.7 0-120.1 48.7-129 112zM0 482.3C0 383.8 79.8 304 178.3 304l91.4 0C368.2 304 448 383.8 448 482.3c0 16.4-13.3 29.7-29.7 29.7L29.7 512C13.3 512 0 498.7 0 482.3z"/></svg>
                                <%= message.author.username %>
                                 <p class="message-date"><% if(locals.user) { %>
                                <%= message.formattedDate %>
                                <% } %>
                            <% }%>
                            </h1>
                            <p class="message-body"><%= message.text %></p>
                            </p>
                        </div>      
                    <% }) %>
                </div>
            <% } %> 
        </div>
        
        
        <div class="friends-container">
            <div class="friends">
                <h1>My Friends</h1>
                <% if (locals.userFriends && locals.user)  {%>
                    <% userFriends.friends.map((friend) => {%>
                        <div class="user-nav">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"/></svg>
                            <p><%= friend.username %></p>
                            <button class="chat-button">
                                <a href="/chat/<%= friend.id %>">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M64 0C28.7 0 0 28.7 0 64L0 352c0 35.3 28.7 64 64 64l96 0 0 80c0 6.1 3.4 11.6 8.8 14.3s11.9 2.1 16.8-1.5L309.3 416 448 416c35.3 0 64-28.7 64-64l0-288c0-35.3-28.7-64-64-64L64 0z"/></svg>
                                    Chat
                                </a>
                            </button>
                        </div>
                   <% }) %>
                <% } %>
            </div>

            <div class="suggested">
                <h1>Suggested</h1>
                <% if (locals.suggestedUsers && locals.user)  {%>
                    <% suggestedUsers.map((suggestedUser) => {%>
                        <div class="user-nav">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l388.6 0c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304l-91.4 0z"/></svg>
                            <p><%= suggestedUser.username %></p>
                            <button class="add-friend-button" data-suggesteduserid="<%= suggestedUser.id %>"> + Add</button>
                        </div>
                   <% }) %>
                <% } %>
            </div>
        </div>       
    </div>

    
    <script src="/deleteMessage.js"></script>    
    <script src="/addFriend.js"></script>
    
</body>
</html>